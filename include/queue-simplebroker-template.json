{
  "apiVersion": "v1",
  "kind": "Template",
  "metadata": {
    "labels": {
      "addressType": "queue",
      "app": "enmasse"
    },
    "name": "queue-simplebroker"
  },
  "objects": [
    {
      "apiVersion": "v1",
      "kind": "DeploymentConfig",
      "metadata": {
        "labels": {
          "address": "${ADDRESS}",
          "app": "enmasse",
          "multicast": "false",
          "store_and_forward": "true",
          "type": "address-config"
        },
        "name": "${NAME}"
      },
      "spec": {
        "replicas": 1,
        "selector": {
          "address": "${ADDRESS}",
          "role": "broker"
        },
        "template": {
          "metadata": {
            "labels": {
              "address": "${ADDRESS}",
              "app": "enmasse",
              "role": "broker"
            }
          },
          "spec": {
            "containers": [
              {
                "env": [
                  {
                    "name": "CONTAINER_ID",
                    "value": "${ADDRESS}"
                  },
                  {
                    "name": "QUEUE_NAME",
                    "value": "${ADDRESS}"
                  }
                ],
                "image": "simplebroker",
                "name": "broker"
              }
            ]
          }
        },
        "triggers": [
          {
            "type": "ConfigChange"
          },
          {
            "imageChangeParams": {
              "automatic": true,
              "containerNames": [
                "broker"
              ],
              "from": {
                "kind": "ImageStreamTag",
                "name": "simplebroker:latest"
              }
            },
            "type": "ImageChange"
          }
        ]
      }
    }
  ],
  "parameters": [
    {
      "description": "A valid name for the instance",
      "name": "NAME",
      "required": true
    },
    {
      "description": "The address to use for the queue",
      "name": "ADDRESS",
      "required": true
    }
  ]
}
